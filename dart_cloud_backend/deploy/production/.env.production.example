# ============================================
# ContainerPub Backend - Production Environment
# ============================================
# Copy this file to .env.production and fill in your secure values
# NEVER commit .env.production to version control!

# ============================================
# Database Configuration (REQUIRED)
# ============================================
POSTGRES_USER=dart_cloud
POSTGRES_PASSWORD=CHANGE_THIS_TO_SECURE_PASSWORD_32_CHARS_MIN
POSTGRES_DB=dart_cloud
POSTGRES_PORT=5432
FUNCTION_DB=functions_db

# Generate secure password with:
# openssl rand -base64 32

# ============================================
# Server Configuration
# ============================================
PORT=8080
FUNCTIONS_DIR=/app/functions
# ============================================
# Podman socket Configuration
# ============================================
PODMAN_SOCKET=/podman.sock
PYTHON_PODMAN_CLI = ./podman_client.py
USE_PODMAN_CLI=true
# ============================================
# Security (REQUIRED)
# ============================================
JWT_SECRET=CHANGE_THIS_TO_LONG_RANDOM_STRING_64_CHARS_MIN

# Generate secure JWT secret with:
# openssl rand -base64 64

# ============================================
# SSL/TLS Configuration
# ============================================
# SSL is enabled by default in production
# Certificates are mounted from ./ssl/ directory
# Connection strings automatically include SSL parameters

# SSL Mode options:
# - disable: No SSL
# - require: SSL required but no certificate verification
# - verify-ca: SSL required with CA verification
# - verify-full: SSL required with full verification (hostname + CA)
SSL_MODE=verify-ca

# ============================================
# Function Execution Limits
# ============================================
FUNCTION_TIMEOUT_SECONDS=5
FUNCTION_MAX_MEMORY_MB=128
FUNCTION_MAX_CONCURRENT=10

# ============================================
# Database Connection Pool
# ============================================
FUNCTION_DB_MAX_CONNECTIONS=10
FUNCTION_DB_TIMEOUT_MS=5000

# ============================================
# Logging
# ============================================
LOG_LEVEL=info
# Options: debug, info, warn, error

# ============================================
# Production Checklist
# ============================================
# Before deploying to production:
# 
# 1. Generate SSL certificates:
#    ./generate-ssl-certs.sh
#
# 2. Generate strong secrets:
#    openssl rand -base64 32  # POSTGRES_PASSWORD
#    openssl rand -base64 64  # JWT_SECRET
#
# 3. Secure this file:
#    chmod 600 .env.production
#
# 4. Verify SSL certificates exist:
#    ls -la ssl/
#
# 5. Test configuration:
#    docker-compose -f docker-compose.prod.yml config
#
# 6. Deploy:
#    docker-compose -f docker-compose.prod.yml up -d
#
# 7. Verify SSL connection:
#    docker-compose exec postgres psql \
#      "sslmode=require host=postgres user=dart_cloud dbname=dart_cloud"
#
# 8. Check logs:
#    docker-compose -f docker-compose.prod.yml logs -f
#
# 9. Monitor health:
#    curl https://your-domain.com/api/health
#
# 10. Set up backups and monitoring

# ============================================
# Security Notes
# ============================================
# - Use strong, random passwords (32+ characters)
# - Rotate secrets regularly (every 90 days)
# - Use different secrets for each environment
# - Enable SSL/TLS for all connections
# - Keep certificates up to date
# - Monitor access logs
# - Implement rate limiting
# - Use firewall rules
# - Regular security audits
# - Backup encryption keys securely
